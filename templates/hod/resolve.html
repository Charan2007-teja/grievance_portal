{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-center mt-4">
  <div class="card shadow p-4 w-100" style="max-width:750px;">

    <h3 class="text-danger fw-bold">Resolve Complaint #{{ complaint.id }}</h3>

    <p><b>Title:</b> {{ complaint.title }}</p>
    <p><b>Status:</b> {{ complaint.status }}</p>
    <hr>

    <h5 class="fw-bold">Previous Response</h5>
    <div class="alert alert-info" style="white-space: pre-line;">
        <b>{{ complaint.response_by }}:</b><br>
        {{ complaint.response }}
    </div>

    <hr>

    <h4 class="fw-bold text-primary">Upload AFTER Work Proof</h4>

    <form method="POST" enctype="multipart/form-data">

        <label class="fw-semibold">Upload FINAL / AFTER Files</label>
        <input type="file"
               name="final_files"
               class="form-control mb-3"
               multiple
               onchange="prefixFiles(event,'AFTER_')">

        <button class="btn btn-success w-100 fw-semibold">
            âœ” Mark as Resolved
        </button>

    </form>
  </div>
</div>

<script>
function prefixFiles(e, prefix) {
    const dt = new DataTransfer();
    for (let f of e.target.files)
        dt.items.add(new File([f], prefix + f.name, { type: f.type }));
    e.target.files = dt.files;
}
</script>

{% endblock %}
